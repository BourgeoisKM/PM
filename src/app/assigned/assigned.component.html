<app-header></app-header>
<app-aside></app-aside>

<main id="main" class="main" data-aos="fade-in" data-aos-duration="600">
  <div class="pagetitle mb-3" data-aos="fade-down" data-aos-duration="700">
    <h1 class="fw-bold text-dark">
      <i class="bi bi-tools me-2"></i>Assign a Preventive Maintenance
    </h1>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#"><i class="bi bi-person-fill"></i> User</a></li>
        <li class="breadcrumb-item active" aria-current="page"><i class="bi bi-list-task"></i> Assign PM</li>
      </ol>
    </nav>
  </div>

  <div class="container" style="max-width: 850px;">
    <div class="card shadow-lg border-0 p-4" data-aos="zoom-in-up" data-aos-duration="800">
      <div class="card-header bg-primary text-white fw-semibold mb-3">
        <i class="bi bi-calendar-plus-fill me-2"></i>Preventive Maintenance Planning
      </div>

      <form [formGroup]="pmForm" (ngSubmit)="assignPM()" class="card-body" novalidate>
        <div class="row g-4 mb-3">
          <!-- FME -->
          <div class="col-md-6">
            <label for="fmeId" class="form-label text-muted fw-semibold">
              <i class="bi bi-person-workspace me-1 text-primary"></i>FME
            </label>
            <select id="fmeId" class="form-select" formControlName="fmeId" (change)="onFMEChange($event)">
              <option value="" disabled selected>-- Select an FME --</option>
              <option *ngFor="let user of fme" [value]="user.id">
                {{ user.fullName }}
              </option>
            </select>
          </div>

          <!-- Site -->
          <div class="col-md-6">
            <label for="siteId" class="form-label text-muted fw-semibold">
              <i class="bi bi-geo-alt-fill me-1 text-primary"></i>Site
            </label>
            <select id="siteId" class="form-select" formControlName="siteId" [disabled]="sites.length === 0">
              <option value="" disabled selected>
                {{ sites.length === 0 ? '-- No sites available --' : '-- Select a site --' }}
              </option>
              <option *ngFor="let site of sites" [value]="site.id">{{ site.name }}</option>
            </select>
          </div>

          <!-- Date -->
          <div class="col-md-6">
            <label for="plannedDate" class="form-label text-muted fw-semibold">
              <i class="bi bi-calendar-event-fill me-1 text-primary"></i>Planned Date
            </label>
            <input id="plannedDate" type="date" class="form-control" formControlName="plannedDate" />
          </div>

          <!-- PM Type -->
          <div class="col-md-6">
            <label for="pmType" class="form-label text-muted fw-semibold">
              <i class="bi bi-gear-wide-connected me-1 text-primary"></i>PM Type
            </label>
            <select id="pmType" class="form-select" formControlName="pmType">
              <option value="" disabled selected>-- Select a type --</option>
              <option value="250H">250H</option>
              <option value="500H">500H</option>
              <option value="1000H">1000H</option>
            </select>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="text-end">
          <button type="submit" class="btn btn-primary px-4 py-2" [disabled]="pmForm.invalid">
            <i class="bi bi-send-fill me-2"></i>Assign PM
          </button>
        </div>
      </form>
    </div>
  </div>
</main>

<app-footer></app-footer>
